{"version":3,"file":"draggable-object-target.js","sources":["../../src/components/draggable-object-target.hbs","../../src/components/draggable-object-target.js"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{#if @enableClicking}}\\n  <a href=\\\"#\\\" {{fn this.acceptForDrop}}>\\n    {{yield}}\\n  </a>\\n{{else}}\\n  {{yield}}\\n{{/if}}\\n\")","/* eslint-disable ember/no-actions-hash, ember/no-classic-classes, ember/no-classic-components, ember/no-component-lifecycle-hooks, ember/no-get, ember/no-mixins, ember/require-tagless-components, prettier/prettier */\nimport { getOwner } from '@ember/application';\nimport Component from '@ember/component';\nimport Droppable from '../mixins/droppable.js';\n\nexport default Component.extend(Droppable, {\n  classNameBindings: ['overrideClass'],\n  overrideClass: 'draggable-object-target',\n  isOver: false,\n\n  // idea taken from https://github.com/emberjs/rfcs/blob/master/text/0680-implicit-injection-deprecation.md#stage-1\n  get coordinator() {\n    if (this._coordinator === undefined) {\n      this._coordinator = getOwner(this).lookup('drag:coordinator');\n    }\n\n    return this._coordinator;\n  },\n  set coordinator(value) {\n    this._coordinator = value;\n  },\n\n  handlePayload(payload, event) {\n    let obj = this.get('coordinator').getObject(payload,{target: this});\n    this.get('action')(obj, { target: this, event: event });\n  },\n\n  handleDrop(event) {\n    let dataTransfer = event.dataTransfer;\n    let payload = dataTransfer.getData(\"Text\");\n    if (payload === '') { return; }\n    this.handlePayload(payload, event);\n  },\n\n  acceptDrop(event) {\n    this.handleDrop(event);\n    //Firefox is navigating to a url on drop sometimes, this prevents that from happening\n    event.preventDefault();\n  },\n\n  handleDragOver(event) {\n    if (!this.get('isOver')) {\n      //only send once per hover event\n      this.set('isOver', true);\n      if(this.get('dragOverAction')) {\n        this.get('dragOverAction')(event);\n      }\n    }\n  },\n\n  handleDragOut(event) {\n    this.set('isOver', false);\n    if(this.get('dragOutAction')) {\n      this.get('dragOutAction')(event);\n    }\n  },\n\n  click(e) {\n    let onClick = this.get('onClick');\n    if (onClick) {\n      onClick(e);\n    }\n  },\n\n  mouseDown(e) {\n    let mouseDown = this.get('onMouseDown');\n    if (mouseDown) {\n      mouseDown(e);\n    }\n  },\n\n  handleMouseEnter(e) {\n    let mouseEnter = this.get('onMouseEnter');\n    if (mouseEnter) {\n      mouseEnter(e);\n    }\n  },\n\n  didInsertElement() {\n      this._super(...arguments);\n      this.element.addEventListener('mouseenter', this.boundHandleMouseEnter);\n  },\n\n  willDestroyElement() {\n      this._super(...arguments);\n      this.element.removeEventListener('mouseenter', this.boundHandleMouseEnter);\n  },\n\n  actions: {\n    acceptForDrop() {\n      let hashId = this.get('coordinator.clickedId');\n      this.handlePayload(hashId);\n    }\n  },\n\n  init() {\n    this._super(...arguments);\n\n    this.set('boundHandleMouseEnter', this.handleMouseEnter.bind(this));\n  }\n});\n"],"names":["setComponentTemplate","TEMPLATE","Component","extend","Droppable","classNameBindings","overrideClass","isOver","coordinator","_coordinator","undefined","getOwner","lookup","value","handlePayload","payload","event","obj","get","getObject","target","handleDrop","dataTransfer","getData","acceptDrop","preventDefault","handleDragOver","set","handleDragOut","click","e","onClick","mouseDown","handleMouseEnter","mouseEnter","didInsertElement","_super","arguments","element","addEventListener","boundHandleMouseEnter","willDestroyElement","removeEventListener","actions","acceptForDrop","hashId","init","bind"],"mappings":"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"}